{% extends 'main/base.html' %}
{% block body %}

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<script>
window.onload = function() {
    if(!window.location.hash) {
        window.location = window.location + '#loaded';
        window.location.reload();
    }
}

function initGeolocation() {
    if (navigator && navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(successCallback, errorCallback);
        } else {
            console.log('Geolocation is not supported');
        }
}
function errorCallback() {}
function successCallback(position) {
    var lat = position.coords.latitude.toString();
    var long = position.coords.longitude.toString();
    var coordinates = lat + ',' + long;
    console.log(coordinates);
    var coords = document.getElementById('coordinates');
    coords.value = coordinates;
    $.ajax({
        url: "{% url 'main:something' %}",
        type: 'POST',
        data: {
            coordinates: coordinates,
            csrfmiddlewaretoken: '{{ csrf_token }}'

        },
    });
}

</script>
<body onload="javascript:initGeolocation()">

<form action="{% url 'main:something' %}" method="POST" id="position_form" >
       {% csrf_token %}
        <label>
            <input name="position" type="hidden" id="coordinates">
        </label>
</form>










</body>

{% endblock %}